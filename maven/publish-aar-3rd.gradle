/*
âš ï¸ä¸Šä¼ ç¬¬ä¸‰æ–¹AARã€JARåˆ°mavenä»“åº“ï¼Œä¸‰æ–¹åº“æ˜¯åœ¨ç‹¬ç«‹çš„ä»“åº“

ğŸš€ğŸš€ğŸš€
1. å°†ä»¥ä¸‹ä»£ç copyåˆ°éœ€è¦è¢«ä¸Šä¼ çš„moduleçš„build.gradleä¸­
2. ç¼–è¯‘ååœ¨IDEä¾§è¾¹gradleè§†çª—:${Module}/Tasks/publishing/ï¼Œæ‰§è¡Œpublish
ğŸš€ğŸš€ğŸš€

ext {
    maven_artifact_file_path = "./xxx.aar"  //arrçš„è·¯å¾„
    maven_version = "x.x.x"
    maven_artifactId = "åå­—"

    maven_description = "æè¿°"
    maven_groupId = "com.xxx.android"
}
apply from: "$build_script_url/maven/publish-aar-3rd.gradle"

*/

// â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ ä½¿ç”¨æ–¹å¼ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘

apply plugin: 'maven-publish'
def maven_build_type = "debug"

publishing {
    publications {
        "${maven_build_type}"(MavenPublication) {
            groupId maven_groupId
            artifactId maven_artifactId
            version maven_version
            artifact maven_artifact_file_path

            // å¦‚éœ€è¦å¯ç”¨pomï¼Œè°ƒç”¨æ–¹éœ€è¦ä¸‹ä¸€è¡Œä»£ç ï¼Œç›®çš„ï¼šåŠ å…¥apply plugin:android,æ‰æœ‰debugç­‰buildType
            // apply from: "$build_script_url/build-lib.gradle"ï¼Œ

            // To include project dependencies
//            pom.withXml {
//                def dependencies = asNode().appendNode('dependencies')
//                // maven_build_type æ ¹æ®build_typeä¸Šä¼ ç›¸åº”çš„dependencies.
//                // å¦‚debugImplementationã€releaseImplementationç­‰ï¼Œæ ¹æ®buildType
//                configurations.getByName("${maven_build_type}CompileClasspath").getResolvedConfiguration().getFirstLevelModuleDependencies().each {
//                    def dependency = dependencies.appendNode('dependency')
//                    dependency.appendNode('groupId', it.moduleGroup)
//                    dependency.appendNode('artifactId', it.moduleName)
//                    dependency.appendNode('version', it.moduleVersion)
//                }
//                asNode().appendNode("description", maven_description)
//            }
        }
    }
    repositories {
        // ä¸‰æ–¹åº“åªæœ‰ä¸€ä»“åº“ï¼Œæ²¡æœ‰snapshotå’Œreleaseä¹‹åˆ†
        maven {
            url maven_3rd_url
            credentials(HttpHeaderCredentials) {
                name = "Private-Token"
                value = maven_3rd_gitLabAccessToken
            }
            authentication {
                header(HttpHeaderAuthentication)
            }
        }
    }
}


